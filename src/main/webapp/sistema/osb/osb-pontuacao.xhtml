<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:p="http://primefaces.org/ui"
	  xmlns:pt="http://java.sun.com/jsf/passthrough"
	  xmlns:c="http://java.sun.com/jstl/core" class="gt-ie8 gt-ie9 not-ie"
      xmlns:s="http://jboss.com/products/seam/taglib"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions">
<h:head/>  
 
<h:body>
	
    <ui:composition template="/template/layout.xhtml">		
        <ui:define name="conteudo">        
        
            <h:form id="formPrincipal" style="font-size: 12px;"> 
                
	  			<p:messages id="messages" closable="true" showDetail="false">
          			<p:autoUpdate />
          		</p:messages>		  			
          		
          		<p:panel header="O Sobrevivente" style="min-width: 250px;">
          		
          			<br/> 
          		
	          		<p:commandButton value="GERAR NOVA RODADA 'O SOBREVIVENTE'" 			    					
	               					 onstart="PF('dialogProcessando').show();" 
	               					 onclick="PF('dialogProcessando').show();"                					 
	               					 oncomplete="PF('dialogProcessando').hide();"									
								     onsuccess="PF('dialogProcessando').hide();"
							 		 onerror="PF('dialogProcessando').hide();"
							 		 update="@form" id="btnNovaRodada"
							 		 rendered="#{osbRodadaControl.novaOsbRodada == null}"
							 		 action="#{osbRodadaControl.btnOsbNovaRodada}"/>
							 		 
							 		 
					<p:commandButton value="ATUALIZAR PONTUACAO" 			    					
	               					 onstart="PF('dialogProcessando').show();" 
	               					 onclick="PF('dialogProcessando').show();"                					 
	               					 oncomplete="PF('dialogProcessando').hide();"									
								     onsuccess="PF('dialogProcessando').hide();"
							 		 onerror="PF('dialogProcessando').hide();"
							 		 update="@form" id="btnAtualizarRodada"
							 		 rendered="#{osbRodadaControl.novaOsbRodada != null}"
							 		 action="#{osbRodadaControl.btnAtualizarRodadaEmAndamento}"/>		
							 		 							 		 					
					<p:commandButton value="EXCLUIR RODADA EM ANDAMENTO" 			    					
	               					 onstart="PF('dialogProcessando').show();" 
	               					 onclick="PF('dialogProcessando').show();"                					 
	               					 oncomplete="PF('dialogProcessando').hide();"									
								     onsuccess="PF('dialogProcessando').hide();"
							 		 onerror="PF('dialogProcessando').hide();"
							 		 update="@form" id="btnExcluirRodada"
							 		 rendered="#{osbRodadaControl.novaOsbRodada != null}"
							 		 action="#{osbRodadaControl.btnExcluirRodadaEmAndamento}"
							 		 style="float: right;"/>	 		 
					
					<br/>	
					
					<hr/>	
										
					<h:outputText value="RODADA EM ANDAMENTO" style="color: red; font-size: 14px; font-weight: bold;" rendered="#{osbRodadaControl.novaOsbRodada != null and 'N'.equals(osbRodadaControl.novaOsbRodada.tipoRodada)}"/>	 
					
					<hr/>
					          		
          			<p:panel header="#{osbRodadaControl.novaOsbRodada.nrRodada}ª Rodada em Andamento (RODADA PADRÃO)" 
          					 rendered="#{osbRodadaControl.novaOsbRodada != null and 'N'.equals(osbRodadaControl.novaOsbRodada.tipoRodada)}"
          					 style="min-width: 230px;">
          				
          				<p:dataTable var="item" value="#{osbRodadaControl.novaOsbRodada.listaOsbPontuacao}"
	      			 				 emptyMessage="Não existem dados" rowIndexVar="rowIndex" style="min-width: 210px; ">
	      			 					 
		      			 	<f:facet name="header">	     
		 			 			<h:outputText value="Classificação da #{osbRodadaControl.novaOsbRodada.nrRodada}ª rodada (RODADA PADRÃO)"/>	 			 		 
		 			 		</f:facet>    
		      			 					 
	     			 		<p:column headerText="#" style="text-align: center; width: 45px; #{rowIndex+1 == osbRodadaControl.novaOsbRodada.listaOsbPontuacao.size() ? 'background-color: #FFC0CB; color: black;' : ''}">
						        <h:outputText value="#{rowIndex+1}" />
						    </p:column>	
						   
						    <p:column headerText="Time" style="width: 50%; #{rowIndex+1 == osbRodadaControl.novaOsbRodada.listaOsbPontuacao.size() ? 'background-color: #FFC0CB; color: black;' : ''}">
						        <img src="#{item.osbRodadaTimeParticipante.time.urlEscudoSvg}" alt="" style="width: 20px;"/> <h:outputText value="#{item.nomeTime}" />
						    </p:column>							    						
						    
						    <p:column headerText="PG" style="text-align: center; width: 80px; #{rowIndex+1 == osbRodadaControl.novaOsbRodada.listaOsbPontuacao.size() ? 'background-color: #FFC0CB; color: black;' : ''}">
						        <h:outputText value="#{item.vrPontuacao}" converter="decimal"/>
						    </p:column>						
						    
						    <p:column headerText="Situacao" style="text-align: center; width: 120px;" 
						    		  rendered="#{rowIndex+1 &lt; osbRodadaControl.novaOsbRodada.listaOsbPontuacao.size()}">
						        <h:outputText value="CLASSIFICADO" />	
						    </p:column>		
						    
						    <p:column headerText="Situacao" style="text-align: center; width: 120px; background-color: #FFC0CB; color: black;"
						   			  rendered="#{rowIndex+1 == osbRodadaControl.novaOsbRodada.listaOsbPontuacao.size() or (rowIndex+1 == osbRodadaControl.novaOsbRodada.listaOsbPontuacao.size()-1 and osbRodadaControl.novaOsbRodada.nrRodada &gt; 28 and osbRodadaControl.novaOsbRodada.nrRodada &lt; 38)}">
						       <h:outputText value="ELIMINADO" />	
						    </p:column>							   			    
						    								   
						</p:dataTable> 
								          			
          			</p:panel>           			
          			
          			<p:panel header="#{osbRodadaControl.novaOsbRodada.nrRodada}ª Rodada em Andamento (REPESCAGEM)" 
          					 rendered="#{osbRodadaControl.novaOsbRodada != null and 'R'.equals(osbRodadaControl.novaOsbRodada.tipoRodada)}"
          					 style="min-width: 230px;">
          				
          				<p:dataTable var="item" value="#{osbRodadaControl.novaOsbRodada.listaOsbPontuacao}"
	      			 				 emptyMessage="Não existem dados" rowIndexVar="rowIndex" style="min-width: 210px; ">
	      			 					 
		      			 	<f:facet name="header">	     
		 			 			<h:outputText value="Classificação da #{osbRodadaControl.novaOsbRodada.nrRodada}ª rodada (REPESCAGEM)"/>	 			 		 
		 			 		</f:facet>    
		      			 					 
	     			 		<p:column headerText="#" style="text-align: center; width: 45px; #{rowIndex+1 &gt; 1 ? 'background-color: #FFC0CB; color: black;' : ''}">
						        <h:outputText value="#{rowIndex+1}" />
						    </p:column>	
						   
						    <p:column headerText="Time" style="width: 50%; #{rowIndex+1 &gt; 1 ? 'background-color: #FFC0CB; color: black;' : ''}">
						        <img src="#{item.osbRodadaTimeParticipante.time.urlEscudoSvg}" alt="" style="width: 20px;"/> <h:outputText value="#{item.nomeTime}" />
						    </p:column>							    						
						    
						    <p:column headerText="PG" style="text-align: center; width: 80px; #{rowIndex+1 &gt; 1 ? 'background-color: #FFC0CB; color: black;' : ''}">
						        <h:outputText value="#{item.vrPontuacao}" converter="decimal"/>
						    </p:column>	
						    
						    <p:column headerText="Situacao" style="text-align: center; width: 120px; background-color: #FFC0CB; color: black;"
						   			  rendered="#{rowIndex+1 &gt; 1}">
						       <h:outputText value="ELIMINADO" />	
						    </p:column>							
						    
						    <p:column headerText="Situacao" style="text-align: center; width: 120px;" 
						    		  rendered="#{rowIndex+1 == 1}">
						        <h:outputText value="CLASSIFICADO" />	
						    </p:column>							   					   			    
						    								   
						</p:dataTable> 
						          			
          			</p:panel>
          			
          			<hr/>    
          			      			
					<center>	 		 
						<p:commandButton value="FINALIZAR RODADA EM ANDAMENTO" 			    					
		               					 onstart="PF('dialogProcessando').show();" 
		               					 onclick="PF('dialogProcessando').show();"                					 
		               					 oncomplete="PF('dialogProcessando').hide();"									
									     onsuccess="PF('dialogProcessando').hide();"
								 		 onerror="PF('dialogProcessando').hide();"
								 		 update="@form" id="btnFinalizarRodada"
								 		 rendered="#{osbRodadaControl.novaOsbRodada != null}"
								 		 action="#{osbRodadaControl.btnFinalizarRodadaEmAndamento}"/> 
					</center>	
					
					<hr/>          			
          			
          			<p:panel> 
          				          			
						<h:outputText value="HISTÓRICO DE RODADAS" style="color: red; font-size: 14px; font-weight: bold;" rendered="#{osbRodadaControl.listaOsbRodadas.size() > 0}"/>	 
												
						<hr/>
		          		          		
						<p:repeat var="var" value="#{osbRodadaControl.listaOsbRodadas}" >	 
											    
							<p:panel header="#{var.nrRodada}ª rodada" toggleable="true" rendered="#{'N'.equals(var.tipoRodada)}">
							
								<p:dataTable var="item" value="#{var.listaOsbPontuacao}"
											 emptyMessage="Não existem dados" rowIndexVar="rowIndex">
												 
									<f:facet name="header">	     
										<h:outputText value="Classificação da #{var.nrRodada}ª rodada (RODADA PADRÃO)"/>	 			 		 
									</f:facet>    						  
				      			 					 
			     			 		<p:column headerText="#" style="text-align: center; width: 45px; #{rowIndex+1 == var.listaOsbPontuacao.size() or (rowIndex+1 == var.listaOsbPontuacao.size()-1 and var.nrRodada &gt; 28 and var.nrRodada &lt; 38) ? 'background-color: #FFC0CB; color: black;' : ''}">
								        <h:outputText value="#{rowIndex+1}" />
								    </p:column>	
								   
								    <p:column headerText="Time" style="width: 50%; #{rowIndex+1 == var.listaOsbPontuacao.size() or (rowIndex+1 == var.listaOsbPontuacao.size()-1 and var.nrRodada &gt; 28 and var.nrRodada &lt; 38) ? 'background-color: #FFC0CB; color: black;' : ''}">
								        <img src="#{item.osbRodadaTimeParticipante.time.urlEscudoSvg}" alt="" style="width: 20px;"/> <h:outputText value="#{item.nomeTime}" />
								    </p:column>							    						
								    
								    <p:column headerText="PG" style="text-align: center; width: 80px; #{rowIndex+1 == var.listaOsbPontuacao.size() or (rowIndex+1 == var.listaOsbPontuacao.size()-1 and var.nrRodada &gt; 28 and var.nrRodada &lt; 38) ? 'background-color: #FFC0CB; color: black;' : ''}">
								        <h:outputText value="#{item.vrPontuacao}" converter="decimal"/>
								    </p:column>						
								    
								    <p:column headerText="Situacao" style="text-align: center; width: 120px;" 
								    		  rendered="#{(rowIndex+1 &lt; var.listaOsbPontuacao.size() and var.nrRodada &lt; 29) or (rowIndex+1 &lt; var.listaOsbPontuacao.size()-1 and var.nrRodada &gt; 28 and var.nrRodada &lt; 38)}">
								        <h:outputText value="CLASSIFICADO" />	
								    </p:column>		
								    
								    <p:column headerText="Situacao" style="text-align: center; width: 120px; background-color: #FFC0CB; color: black;"
								   			  rendered="#{rowIndex+1 == var.listaOsbPontuacao.size() or (rowIndex+1 == var.listaOsbPontuacao.size()-1 and var.nrRodada &gt; 28 and var.nrRodada &lt; 38)}">
								       <h:outputText value="ELIMINADO" />	
								    </p:column>					 				    
																	   
								</p:dataTable> 
							</p:panel>
							
							<p:panel header="#{var.nrRodada}ª rodada" toggleable="true" rendered="#{'R'.equals(var.tipoRodada)}">
								
								<p:dataTable var="item" value="#{var.listaOsbPontuacao}"
											 emptyMessage="Não existem dados" rowIndexVar="rowIndex">
	      			 					 
				      			 	<f:facet name="header">	     
				 			 			<h:outputText value="Classificação da #{var.nrRodada}ª rodada (REPESCAGEM)"/>				 		 
				 			 		</f:facet>    
				      			 					 
			     			 		<p:column headerText="#" style="text-align: center; width: 45px; #{rowIndex+1 &gt; 1 ? 'background-color: #FFC0CB; color: black;' : ''}">
								        <h:outputText value="#{rowIndex+1}" />
								    </p:column>	
								   
								    <p:column headerText="Time" style="width: 50%; #{rowIndex+1 &gt; 1 ? 'background-color: #FFC0CB; color: black;' : ''}">
								        <img src="#{item.osbRodadaTimeParticipante.time.urlEscudoSvg}" alt="" style="width: 20px;"/> <h:outputText value="#{item.nomeTime}" />
								    </p:column>							    						
								    
								    <p:column headerText="PG" style="text-align: center; width: 80px; #{rowIndex+1 &gt; 1 ? 'background-color: #FFC0CB; color: black;' : ''}">
								        <h:outputText value="#{item.vrPontuacao}" converter="decimal"/>
								    </p:column>	
								    
								    <p:column headerText="Situacao" style="text-align: center; width: 120px; background-color: #FFC0CB; color: black;"
								   			  rendered="#{rowIndex+1 &gt; 1}">
								       <h:outputText value="ELIMINADO" />	
								    </p:column>							
								    
								    <p:column headerText="Situacao" style="text-align: center; width: 120px;" 
								    		  rendered="#{rowIndex+1 == 1}">
								        <h:outputText value="CLASSIFICADO" />	
								    </p:column>							   					   			    
								    								   
								</p:dataTable> 
								
							</p:panel>
							
							<hr/>
								
						</p:repeat>
						
					</p:panel>			          		
          		          		
          		</p:panel>        		   		           		
	                             
	            <p:dialog widgetVar="dialogProcessando" modal="true" 
						  resizable="false;" draggable="false"
					      closable="false" id="dialogProcessando" 					      
					      style="z-index: 9999; font-size: 14px; border: 0px; background-color: #D3E6FF !important;">						     				    				
					<center>
						<h:outputText value="Por favor, aguarde." style="font-weight: bold; font-size: 14px;" />
						<br/>
						<img src="publico/estilo/images/loading.gif"/> 
						<br/>
					</center>						
				</p:dialog>
				
            </h:form>
            
        </ui:define>
    </ui:composition>
</h:body>



</html>